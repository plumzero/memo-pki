1.消息认证的定义
  1）消息认证就是使意定的接收者能够检验收到的消息是否真实和完整。
  2）消息认证的内容应该包括：
	 ① 证实消息的信源和信宿；
	 ② 消息内容是否曾受到偶然或有意的篡改；
	 ③ 消息的序号和时间性是否正确；
  3）消息认证只是在朴互通信双方之间进行，而不允许第三者进行上述认证；
  4）消息认证不一定是实时的，如存储系统和电子邮件系统；
  5）在网络的应用中，许多报文并不需要加密。应当使接收者能用很简单的方法鉴别消息的真伪。如何让信息的接收者来有效
     地认证没有加密的消息来源的真实性和完整性，这正是消息认证的目的和作用。
2.消息认证的分类
  1）从层次角度上看，消息认证系统的功能一般划分成两个基本的层次：认证算法和认证协议。
  2）认证算法：在较低的层次上，系统需要提供某种消息认证函数 f 来产生一个用于实现消息认证的认证符。认证符也称为识
     别码，是一个根据消息或者报文计算出来的值，信源端和目的端利用消息认证函数 f 来进行消息认证。一般由消息的发送
	 方产生认证符，并传递给接收方。
  3）认证协议：消息的接收者通过认证协议完成对接收到的消息的合法性鉴别和认证，底层的认证函数通常作为一个原语，为
     高层认证协议的各项功能提供服务。
3.认证函数
  1）系统的认证函数 f 是决定消息认证系统特性的主要因素。
  2）根据认证符的生成方式，在消息认证方案中所采用的认证函数可以分为三类：
	 ① 消息加密函数：用完整信息的密文本身充当认证信息来实现信息的认证；
	 ② 消息认证码：消息在一个被密钥（仅由通信双方共享）控制的公开函数作用后产生一个固定长度的短数据块（也称"消
	    息摘要"或"报文摘要"），并将该数据块加载到消息后面用作消息的认证符（也称为密码校验和），来实现对消息的认
		证；
	 ③ 散列函数：是一个公开的函数，它将任意长的信息映射成一个固定长度的信息（称为散列值）来作为认证信息（无需密
	    钥），并以散列值作为认证符；
  3）相应的消息认证方案也可以分为三类：
     ① 采用消息加密函数的消息认证方案；
	 ② 采用消息认证码的消息认证方案；
	 ③ 采用散列函数的消息认证方案；
4.采用消息加密函数的消息认证方案
  1）基于对称密钥加密体制的消息认证方案
     ① 通信双方通过加密密钥 K 对消息进行加密，加密密钥 K 仅由通信双方共享；
     ② 这种方式不能提供数字签名功能，因为收发双方共享密钥 K，所以接收方可以伪造接收的消息，发送方可以否认发过的
	    消息。
     ③ 消息的内容对于信息的接收者来说是完全未知的，接收者如何才能判断接收到的密文的合法性呢？解决这个问题的一种
	    有效方法是强制明文使其具有某种结构，这种结构易于识别、不能被复制，同明文相关，并且不依赖于加密。最简单的
		方法是在对明文消息进行加密之前，在消息上附加一个错误检测码。接收方收到密文并解密后，对明文使用公开检验函
		数计算检错码是否匹配。
  2）基于公开密钥加密体制的消息认证方案
     ① 发送方Alice利用自己的私钥加密消息，接收方Bob利用Alice的公钥解密进行认证；
	 ② 实际应用时需要在明文中附加一些特定的结构来提高其认证能力，这些附加结构中一般包含用户Alice的数字签名信息；
	 ③ 此方案仅提供消息认证和签名功能，不提供保密性。为了同时提供保密性和认证功能，发送方Alice可以先用自己的私
	    钥对明文消息进行加密以提供数字签名，然后再使用接收方Bob的公钥进行加密来提供保密性。
5.采用消息认证码的消息认证方案
  1）消息认证码有两个输入：变长的明文消息和仅由收文双方共享的密钥；
  2）如果一个消息包括一个序号等控制信息，那么接收者也能够确信这些控制信息的正确性，因为攻击者不知道密钥，所以无
     法成功地更改这些控制信息；
  3）普通的消息认证过程中，由于消息本身在发送过程中是明文形式，所以这一过程只提供认证性而未提供保密性。为提供保密
     性可在对消息使用MAC函数之后或之前进行一次加密，而且加密密钥也需被收文双方共享。显然，在这两种情况下都需要两个
	 独立的密钥 K1 和 K2，每个密钥都需要由发送方和接收方共享；
  4）通常的做法：用消息M作为输入来计算出MAC，然后MAC与消息M连接在一起作为一个整体再被加密；
6.MAC函数与加密算法的区别与联系
  1）两者类似，都需要密钥；
  2）加密算法必须是可逆的，而MAC函数不必是可逆的，它可以是一个单向函数；
  3）MAC函数不能用于实现保密性，认证函数与保密函数的分离能提供结构上的灵活性；
  4）在某些应用中，认证消息比保密消息更为重要；
  5）认证函数MAC并不提供数字签名功能，因为收发双方共享相同的密钥；
7.数据认证算法
  1）数据认证算法是最广泛使用的消息认证码中的一个；
  2）数据认证算法基于CBC模式的DES算法，其初始向量取为零向量，需被认证的数据（消息、记录、文件或程序）被分为64bit
     长的分组 D1, D2, ..., Dn, 其中最后一个分组如果不够 64bit，可在其右边填充一些0；
  3）示意图
				第1次					第2次						第n次
			+-----------+			+-----------+				+-----------+
			| D1(64bit) |			| D2(64bit) |				| Dn(64bit) |
			+-----------+			+-----------+				+-----------+
				  |                       |                     	  |
				  |	         +----------->         +----> On-1 --->
				  ↓          |            ↓          |           	  ↓
			+-----------+    |		+-----------+    |   		+-----------+
		K → |  DES加密  |    |  K → |  DES加密  |	 | ...  K →	|  DES加密  |
	 (56bit)+-----------+    |		+-----------+    |			+-----------+
		          |          |            |          |
                  ↓          |            ↓          |
			+-----------+    |		+-----------+    |			+-----------+
			| O1(64bit) +----+		| O2(64bit) +----+      	| On(64bit) |
			+-----------+			+-----------+				+-----------+
     数据认证码或者取 On 或者取为 On 的最左 M 个比特，其中 16 ≤ M ≤ 64；
  4）我想，数据认证算法也可以使用AES算法；
8.散列函数的概念
  1）散列函数也可以看作是一种单向密码体制，即只有加密过程，不能解密；
  2）抗弱碰撞性：对于任何给定的消息 m 及其散列值，找到另一个能映射出该散列值的消息 m’ 不可行；
  3）抗强碰撞性：找到两个具有同一散列值的消息，不可行；
9.散列函数与消息认证码的联系与区别
  1）与密钥相关的单向散列函数通常称为MAC，由于需要密钥的参与，所以MAC计算速度慢；Hash码的产生过程并不使用密钥，效
     率较高；
  2）目前，最常用的MAC构造方法通常基于某种散列函数（比如 MD5，SHA-1 等）,比如 HMAC 等算法就是采用这种方式构造的。当
     然，MAC 也可以基于分组密码算法(CBC)工作模式的构造方法构造 MAC，比如数据认证算法；
10.采用散列函数的消息认证方案
  1）消息与散列值拼接后使用对称密码技术进行加密，密钥仅为收文双方共享；既提供了消息认证，也提供了消息保密；
  2）使用对称密码技术仅对散列值进行加密；适用于只提供消息认证，不需要对消息进行保密的情况；
  3）使用公钥密码技术和发送方的私钥仅对散列值进行加密；既提供消息认证，又提供数字签名；
  4）使用公钥密码技术和发送方的私钥仅对散列值进行加密，后与消息进行拼接，然后再对拼接后的结果使用对称密码技术进行加
     密；既提供了保密性，也提供了数字签名功能；
  5）通信双方共享一个公共秘密值 S ,发送方Alice对串接的消息 m 和 S 计算出散列值，将得到的散列值附加在消息 m 后发送给
     接收方Bob；秘密值 S 并不被发送；仅提供认证功能；
  6）通过对方法 5）的消息与散列值拼接后的结果再用对称密码技术进行加密，从而实现了保密性
  如何选择？
  一般来说，在不需要数据保密功能的时候，只对散列值进行加密可以大大降低计算量，因此，在不要求保密性的情况下，方法 2）
  和 3） 在降低计算量上要优于那些需要对整个消息进行加密的方法。
  对于方法 5），采用秘密值的方法避免了加密过程，且跳过了对很多受到专利保护或出口限制的加密算法的考虑，可以有效降低成
  本。
11.Hash散列算法的应用
  1）数字签名；
  2）生成程序或文档的"数字指纹"；
  3）用于安全地存储口令；
  4）用于伪随机数的生成；
12.HMAC算法概述
  1）HMAC是消息认证码MAC的一种，是与密钥相关的哈希运算消息认证码；
  2）HMAC可以与任何迭代散列函数捆绑使用；
  3）HMAC所能提供的消息认证包括两个方面：
     ① 消息完整性认证
	 ② 信源身份认证
  3）HMAC算法推荐密钥 K 的长度大于等于 n bit, n 为嵌入的散列函数所产生的散列值的长度。
  4）当密钥 K 的长度超过 b bit 时（b 为每次处理的输入分组长度），则首先把密钥 K 作为消息输入散列函数 H，使用散列函数
     对 K 进行压缩产生一个 n bit 的散列值，并将此散列值作为密钥 K；
  5）HMAC算法步骤：
     ① 如果密钥长度 K 的长度小于 b bit,则在其左边填充一些 "0"，使其成为长度为 b bit 的比特串，记为 K+；
	 ② K+ 与 模式串 ipad (b bit 长度)逐比特异或以产生 b bit 的分组 Si；
	 ③ 把 HMAC 的输入消息 M=Y1Y2...YL（Yi 为输入消息的第 i 个分组）附加在 Si 的右端，将该比特串作为散列函数的输入，
	    得到 n bit 的输出；
	 ④ K+ 与 模式串 opad (b bit 长度)逐比特异或以产生 b bit 的分组 So；
	 ⑤ 将步骤 ③ 得到的散列值附加在 So 的右端，并以该比特串作为散列函数的输入，得到 n bit 的输出，即为 HMAC 值；